const t=new class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.initialState=JSON.parse(JSON.stringify(t)),this.board=JSON.parse(JSON.stringify(this.initialState)),this.status="idle",this.score=0}start(){this.status="playing",this.addRandomTiles(),this.addRandomTiles(),this.updateUI()}restart(){this.score=0,this.board=JSON.parse(JSON.stringify(this.initialState)),this.status="idle",this.updateUI()}getScore(){return this.score}getState(){return this.board}getStatus(){return this.status}moveLeft(){this.move("left")}moveRight(){this.move("right")}moveUp(){this.move("up")}moveDown(){this.move("down")}move(t){"playing"===this.status&&this.checkForMove(t)&&(("up"===t||"down"===t)&&(this.board=this.transposeBoard(this.board)),this.slide(t),this.merge(t),this.slide(t),("up"===t||"down"===t)&&(this.board=this.transposeBoard(this.board,!0)),this.addRandomTiles(),this.checkGameStatus(),this.updateUI())}checkGameStatus(){if(!this.canMove()){this.status="lose";return}this.board.forEach(t=>{t.some(t=>2048===t)&&(this.status="win")})}canMove(){return this.checkForMove("up")||this.checkForMove("down")||this.checkForMove("left")||this.checkForMove("right")}checkForMove(t){for(let e of"up"===t||"down"===t?this.transposeBoard(this.board):this.board)for(let s=0;s<e.length-1;s++)if("down"===t||"right"===t){if(0!==e[s]&&0===e[s+1]||0!==e[s]&&e[s]===e[s+1])return!0}else if(("up"===t||"left"===t)&&(0!==e[s+1]&&0===e[s]||0!==e[s+1]&&e[s+1]===e[s]))return!0;return!1}slide(t){this.board=this.board.map(e=>{let s=e.filter(t=>0!==t);for(;s.length<e.length;)"left"===t||"up"===t?s.push(0):s.unshift(0);return s})}merge(t){let e="right"===t||"down"===t;this.board.forEach(t=>{for(let s=e?t.length-1:0;e?s>=0:s<t.length;e?s--:s++){let r=e?s-1:s+1;t[s]===t[r]&&(t[s]*=2,t[r]=0,this.score+=t[s])}})}transposeBoard(t,e=!1){let s=[[],[],[],[]];for(let r=0;r<t.length;r++)for(let o=0;o<t.length;o++)e?s[r][o]=t[o][r]:s[o][r]=t[r][o];return s}updateUI(t=!1){[...document.querySelectorAll(".field-row")].forEach((t,e)=>{[...t.cells].forEach((t,s)=>{let r=this.board[e][s];t.textContent=0===r?"":r,t.className=`field-cell field-cell--${r}`})})}addRandomTiles(){let t=[];if(this.board.forEach((e,s)=>{e.forEach((e,r)=>{0===e&&t.push({row:s,col:r})})}),!t.length)return;let e=Math.floor(Math.random()*t.length),{row:s,col:r}=t[e],o=.9>Math.random()?2:4;this.board[s][r]=o}},e=document.querySelector(".button"),s=document.querySelector(".game-score");e.addEventListener("click",()=>{let r=document.querySelector(".message-start"),o=document.querySelector(".message-lose"),i=document.querySelector(".message-win");e.classList.contains("start")?(t.start(),r.hidden=!0,e.textContent="Restart",e.classList.remove("start"),e.classList.add("restart")):(t.restart(),s.textContent="0",e.textContent="Start",e.classList.remove("restart"),e.classList.add("start"),r.hidden=!1,o.classList.add("hidden"),i.classList.add("hidden"))}),document.addEventListener("keydown",e=>{"ArrowLeft"===e.key?t.moveLeft():"ArrowRight"===e.key?t.moveRight():"ArrowUp"===e.key?t.moveUp():"ArrowDown"===e.key&&t.moveDown(),s.textContent=t.getScore();let r=document.querySelector(".message-lose"),o=document.querySelector(".message-win");"win"===t.getStatus()?(o.classList.remove("hidden"),r.classList.add("hidden")):"lose"===t.getStatus()&&(r.classList.remove("hidden"),o.classList.add("hidden"))});
//# sourceMappingURL=index.856cee25.js.map
